<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Integration of single-cell/nuclei RNA-seq data as reference — construct_ref • SCdeconR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Integration of single-cell/nuclei RNA-seq data as reference — construct_ref"><meta property="og:description" content="Integration of scRNA-seq or snRNA-seq data using either harmony or seurat."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCdeconR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Cell_type_deconvolution_and_differential_analysis.html">Cell type deconvolution and differential analysis</a>
    </li>
    <li>
      <a href="../articles/Deconvolution_with_scaden_for_spatial_transcriptomics_data.html">Deconvolution with scaden for spatial transcriptomics data</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Liuy12/SCdeconR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Integration of single-cell/nuclei RNA-seq data as reference</h1>
    <small class="dont-index">Source: <a href="https://github.com/Liuy12/SCdeconR/blob/HEAD/R/reference_construction.R" class="external-link"><code>R/reference_construction.R</code></a></small>
    <div class="hidden name"><code>construct_ref.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Integration of scRNA-seq or snRNA-seq data using either harmony or seurat.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">construct_ref</span><span class="op">(</span></span>
<span>  <span class="va">ref_list</span>,</span>
<span>  <span class="va">phenodata_list</span>,</span>
<span>  data_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cellranger"</span>, <span class="st">"h5"</span>, <span class="st">"matrix"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"harmony"</span>, <span class="st">"seurat"</span><span class="op">)</span>,</span>
<span>  <span class="va">group_var</span>,</span>
<span>  nfeature_rna <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  percent_mt <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  vars_to_regress <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"percent_mt"</span>, <span class="st">"phase"</span><span class="op">)</span>,</span>
<span>  ex_features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  resolution <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ref_list</dt>
<dd><p>a character vector of data paths to scRNA-seq/snRNA-seq. See <code>data_type</code> for accepted data types.</p></dd>


<dt>phenodata_list</dt>
<dd><p>a character vector of data paths to metadata for elements in ref_list. All metadata within phenodata_list should have consistent column names. Columns represent
cell attributes, such as cell type, rows represent cells. Each element in <code>phenodata_list</code> should at least contain the first two columns as:</p><ol><li><p>cell barcodes</p></li>
<li><p>cell types</p></li>
</ol></dd>


<dt>data_type</dt>
<dd><p>data type of the input scRNA-seq/snRNA-seq data. Could be either a single character value from "cellranger", "h5", "matrix", or
a vector/list of values with the same length as ref_list indicating the data type for each element.</p></dd>


<dt>method</dt>
<dd><p>character value specifying the method to use. Has to be one of "harmony" or "seurat". See details for more information.</p></dd>


<dt>group_var</dt>
<dd><p>a vector of character values indicating which variables within phenodata_list metadata to use for integration. Only applicable when method
is set to "harmony".</p></dd>


<dt>nfeature_rna</dt>
<dd><p>minimum # of features with non-zero UMIs. Cells with # of features lower than nfeature_rna will be removed. Default to 200.</p></dd>


<dt>percent_mt</dt>
<dd><p>maximum percentage of mitochondria (MT) mapped UMIs. Cells with MT percentage higher than percent_mt will be removed. Default to 40.</p></dd>


<dt>vars_to_regress</dt>
<dd><p>a list of character values indicating the variables to regress for SCTransform normalization step. Default is to regress
out MT percentage ("percent_mt") &amp; cell cycle effects ("phase")</p></dd>


<dt>ex_features</dt>
<dd><p>a vector of character values indicating genes to exclude from anchor features. Those genes will not be considered as
anchor features for integration, but will still be present in the integrated data.</p></dd>


<dt>cluster</dt>
<dd><p>logical value indicating whether to perform clustering on the integrated data. If TRUE, unsupervised clustering will be performed, and
the results will be saved in "seurat_clusters" metadata in the output Seurat object.</p></dd>


<dt>resolution</dt>
<dd><p>numeric value specifying resolution to use when cluster is set to TRUE.</p></dd>


<dt>verbose</dt>
<dd><p>logical value indicating whether to print messages.</p></dd>


<dt>...</dt>
<dd><p>additional parameters passed to <code><a href="https://satijalab.org/seurat/reference/SCTransform.html" class="external-link">SCTransform</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code><a href="https://satijalab.org/seurat/reference/Seurat-class.html" class="external-link">Seurat-class</a></code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>data_type can be chosen from:</p><dl><dt>cellranger</dt>
<dd><p>path to a directory containing the matrix.mtx, genes.tsv (or features.tsv), and barcodes.tsv files outputted by 10x's cell-ranger</p></dd>

 <dt>h5</dt>
<dd><p>path to .h5 file outputted by 10x's cell-ranger</p></dd>

 <dt>matrix</dt>
<dd><p>path to a matrix-like file, with rows representing genes, columns representing cells.</p></dd>


</dl><p>SCTransform with <code>vst.flavor = "v2"</code> is used for normalization of individual data. Integration methods can be chosen from either "harmony"
or "seurat". Harmony typically is more memory efficient and, recommended if you have large # of cells for integration.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## random subset of two scRNA-seq datasets for breast tissue</span></span></span>
<span class="r-in"><span><span class="va">ref_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"SCdeconR"</span><span class="op">)</span>, <span class="st">"/refdata/sample1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"SCdeconR"</span><span class="op">)</span>, <span class="st">"/refdata/sample2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenopath1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"SCdeconR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="st">"/refdata/phenodata_sample1.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenopath2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"SCdeconR"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="st">"/refdata/phenodata_sample2.txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phenodata_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">phenopath1</span>,<span class="va">phenopath2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Register backend for parallel processing</span></span></span>
<span class="r-in"><span><span class="fu">registerDoFuture</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plan</span><span class="op">(</span><span class="st">"multisession"</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## construct integrated reference data</span></span></span>
<span class="r-in"><span><span class="va">refdata</span> <span class="op">&lt;-</span> <span class="fu">construct_ref</span><span class="op">(</span>ref_list <span class="op">=</span> <span class="va">ref_list</span>,</span></span>
<span class="r-in"><span>                         phenodata_list <span class="op">=</span> <span class="va">phenodata_list</span>,</span></span>
<span class="r-in"><span>                         data_type <span class="op">=</span> <span class="st">"cellranger"</span>,</span></span>
<span class="r-in"><span>                         method <span class="op">=</span> <span class="st">"harmony"</span>,</span></span>
<span class="r-in"><span>                         group_var <span class="op">=</span> <span class="st">"subjectid"</span>,</span></span>
<span class="r-in"><span>                         nfeature_rna <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                         vars_to_regress <span class="op">=</span> <span class="st">"percent_mt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yuanhang Liu.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

